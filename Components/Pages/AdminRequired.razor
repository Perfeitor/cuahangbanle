@page "/AdminRequired"

@using Microsoft.AspNetCore.Authorization
@using Microsoft.EntityFrameworkCore
@using cuahangbanle.Components.Services

@inject IUserService userService
@inject IUserProfileService userProfileService

@attribute [Authorize]

<PageTitle>AdminRequired</PageTitle>

<AuthorizeView Roles="Admin">
    <Authorized>
        <MudText Typo="Typo.h3" GutterBottom="true">Bạn đã đăng nhập dưới quyền quản trị viên</MudText>
        <MudText Class="mb-4">Hello @context.User.Identity?.Name!</MudText>
    </Authorized>
    <NotAuthorized>
        <MudAlert Severity="Severity.Warning">Bạn cần có quyền Admin để truy cập trang này</MudAlert>
    </NotAuthorized>
</AuthorizeView>

@code {
    string? UserID;

    protected override async Task OnInitializedAsync()
    {
        var userPrincipal = await userService.GetCurrentUserPrincipal();
        UserID = userPrincipal.FindFirst(c => c.Type.Contains("nameidentifier"))?.Value;
        base.OnInitialized();
    }
}